<?php
if(isset($_POST['fronlogin'])){
    extract($_POST);

    global $db;

    if(!empty($_POST['dpseudo'])  &&  !empty($_POST['mpseudo']) )
    {
        $q = $db -> prepare("SELECT * FROM utilisateurs WHERE pseudo = :pseudo");
        $q -> execute(['pseudo' => $_POST['dpseudo']]);
        $result= $q -> fetch();

        $nv_iden=$_POST['mpseudo'];

        $hashpassword = $result['password'];
        if($result ==true){
            if(password_verify($lpassword, $result['password'])){
            //$q= $db ->prepare("INSERT INTO utilisateurs(pseudo) VALUES (:pseudo)");
            $q= $db ->prepare("UPDATE utilisateurs SET pseudo =  '$nv_iden' WHERE pseudo = :pseudo");
            
            $q ->execute([
            'pseudo' =>$_POST['dpseudo']
            ]); ?>

           <div class="sentence6" > <?php  echo "L'identifiant a été modifié";  ?> </div>
                <?php
        }}else{ ?>
            <div class="sentence6" > <?php  echo "L'identifiant n'a pas été modifié";  ?> </div>
       <?php
        }
    
        
        if($result == true){
            //le compte exixte bien
            $hashpassword = $result['password'];
            if(password_verify($lpassword, $result['password'])){ ?>
                <div class="sentence" > <?php   echo "Le mot de passe est bon";  ?> </div>
           <?php }else{ ?>
                <div class="sentence" > <?php   echo "Le mot de passe n'est pas correcte";  ?> </div>
           <?php }
        }else{ ?>
            <div class="sentence" > <?php   echo "Le compte portant l'identifiant: ".$_POST['dpseudo']." n'existe pas";  ?> </div>
         <?php }
    }
    else{ ?>
        <div class="sentence" > <?php  echo " Veuillez compléter l'ensemble des champs";  ?> </div>
        <?php
    }
}
?>

